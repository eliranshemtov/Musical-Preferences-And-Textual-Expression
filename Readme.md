# Musical Preferences & Textual expression

This repository's purpose is mainly exploration around the feasibility of a research around the question of:

`The relationship between a person's musical preferences and the way this person expresses textually`.

The progress is fully documented in the step-based Jupyter notebooks as part of this repository. <br>

The detailed data and the filtered detailed data (activity of top 1000 of every one of our 5 musical genres) could be found here: <br>

- [detailed_data.zip](https://drive.google.com/file/d/11PtFdQ9bxnH7Fm71C_dyixF35LfocBsp/view?usp=sharing)
- [detailed_filtered_data.zip](https://drive.google.com/file/d/1AB-L1Vcy_i47YKwax0UGPKL3m_1XAyeK/view?usp=drive_link)
- [detailed filtered data in Hugging Face ü§ó](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/tree/main/detailed_filtered_data/texts)

## Reddit Dataset Embeddings (H5 files, per musical genre)

The vectors were created using the `intfloat/e5-large-v2`. All are available for download üëá

- [classical.h5](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/classical.h5)
- [electronic.h5](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/electronic.h5)
- [hiphopheads.h5](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/hiphopheads.h5)
- [indieheads.h5](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/indieheads.h5)
- [metal.h5](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/metal.h5)

‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è This model was used for intermediate analysis only: </br>
Full dataset vectorized with the `all-MiniLM-L6-v2` model [For download](https://huggingface.co/datasets/Musical-Preferences-And-Textual-Expression/musical-preferences-and-personality-traits/blob/main/detailed_filtered_data/vectors/mini_reddit_data_vectorized.pkl). 

## Final Logistic Regression Models

Are available [here](https://github.com/eliranshemtov/Musical-Preferences-And-Textual-Expression/tree/main/models/step-10) as part of this repository.

The files named `my_personality_gpt_<personality-trait>.pkl` are the models that were trained with the `myPersonality` dataset combined with the dataset generated by GPT-3.5.

The files named `gpt_<personality-trait>.pkl` are the models that were trained with the GPT-3.5 datasets (and tested on Gemini's datasets), and performed better than those that used `myPersonality` too.

## Load the Reddit dataset

To load the Reddit dataset with vectors (using [12-appendix-load-dataset-and-vectors.ipynb](https://github.com/eliranshemtov/Musical-Preferences-And-Textual-Expression/tree/main/notebooks/12-appendix-load-dataset-and-vectors.ipynb) for example), you need to download the H5 vectors files and the texts files mentioned above, and locate them at `data/detailed_filtered_data/vectors`.

Running the [12-appendix-load-dataset-and-vectors.ipynb](https://github.com/eliranshemtov/Musical-Preferences-And-Textual-Expression/tree/main/notebooks/12-appendix-load-dataset-and-vectors.ipynb) notebook, including the predictions part should take ~3 minutes.
